\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8\relax}]
\PYG{n+nf}{tape}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }DynamicalSystem
tape\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }mkdyn\PYG{+w}{ }TapeState\PYG{+w}{ }tapeInterface\PYG{+w}{ }tapeBehavior

\PYG{n+nf}{preTuring}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }DynamicalSystem
preTuring\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }tape\PYG{+w}{ }\PYGZam{}\PYGZam{}\PYGZam{}\PYG{+w}{ }processor

\PYG{k+kr}{open}\PYG{+w}{ }DynamicalSystem
\PYG{n+nf}{Word}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }\PYG{k+kt}{Set}
Word\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }Vec\PYG{+w}{ }‚Ñ§\PYG{+w}{ }\PYG{l+m+mi}{256}
\PYG{n+nf}{toInt}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }Alphabet\PYG{+w}{ }\PYG{o+ow}{‚Üí}\PYG{+w}{ }‚Ñ§
toInt\PYG{+w}{ }\PYG{esc}{$\mathbb{0}$}\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}‚Ñ§
toInt\PYG{+w}{ }\PYG{esc}{$\mathbb{1}$}\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}‚Ñ§
toInt\PYG{+w}{ }ùïì\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}‚Ñ§\PYG{+w}{ }+‚Ñ§\PYG{+w}{ }\PYG{l+m+mi}{1}‚Ñ§
\PYG{n+nf}{turingWiringDiagram}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }Lens\PYG{+w}{ }\PYG{o}{(}interface\PYG{+w}{ }preTuring\PYG{o}{)}\PYG{+w}{ }\PYG{o}{(}haltingEmitter\PYG{+w}{ }Word\PYG{+w}{ }‚ä§\PYG{o}{)}
turingWiringDiagram\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }outerOutput\PYG{+w}{ }‚áÜ\PYG{+w}{ }fillInputs
\PYG{+w}{ }\PYG{+w}{ }\PYG{k+kr}{where}\PYG{+w}{ }outerOutput\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }TapeOutput\PYG{+w}{ }√ó\PYG{+w}{ }ProcessorOutput\PYG{+w}{ }\PYG{o+ow}{‚Üí}\PYG{+w}{ }\PYG{o}{(}Word\PYG{+w}{ }‚äé\PYG{+w}{ }‚ä§\PYG{o}{)}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }outerOutput\PYG{+w}{ }\PYG{o}{(}goOut\PYG{+w}{ }x\PYG{+w}{ },\PYG{+w}{ }procOut\PYG{o}{)}\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }inj‚ÇÇ\PYG{+w}{ }tt
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }outerOutput\PYG{+w}{ }\PYG{o}{(}haltOut\PYG{+w}{ }x\PYG{+w}{ },\PYG{+w}{ }\PYGZus{}\PYG{o}{)}\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }inj‚ÇÅ\PYG{+w}{ }\PYGZdl{}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }Data.Vec.map\PYG{+w}{ }\PYG{o}{(}toInt\PYG{+w}{ }‚àò\PYG{+w}{ }x\PYG{o}{)}\PYG{+w}{ }\PYG{o}{(}tabulate\PYG{+w}{ }\PYG{o}{(}+\PYGZus{}\PYG{+w}{ }‚àò\PYG{+w}{ }to‚Ñï\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nf}{fillInputs}\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }\PYG{o}{(}fromPos\PYG{+w}{ }\PYG{o+ow}{:}\PYG{+w}{ }position\PYG{+w}{ }\PYG{o}{(}interface\PYG{+w}{ }preTuring\PYG{o}{)}\PYG{o}{)}\PYG{+w}{ }\PYG{o+ow}{‚Üí}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }direction\PYG{+w}{ }\PYG{o}{(}haltingEmitter\PYG{+w}{ }Word\PYG{+w}{ }‚ä§\PYG{o}{)}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{o}{(}outerOutput\PYG{+w}{ }fromPos\PYG{o}{)}\PYG{+w}{ }\PYG{o+ow}{‚Üí}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }direction\PYG{+w}{ }\PYG{o}{(}interface\PYG{+w}{ }preTuring\PYG{o}{)}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }fromPos
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }fillInputs\PYG{+w}{ }\PYG{o}{(}goOut\PYG{+w}{ }tapeInstruction\PYG{+w}{ },\PYG{+w}{ }move\PYG{+w}{ }procInstruction\PYG{o}{)}\PYG{+w}{ }tt\PYG{+w}{ }\PYG{o+ow}{=}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }move\PYG{+w}{ }procInstruction\PYG{+w}{ },\PYG{+w}{ }instruction\PYG{+w}{ }tapeInstruction
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }fillInputs\PYG{+w}{ }\PYG{o}{(}goOut\PYG{+w}{ }tapeInstruction\PYG{+w}{ },\PYG{+w}{ }write\PYG{+w}{ }procInstruction\PYG{o}{)}\PYG{+w}{ }tt\PYG{+w}{ }\PYG{o+ow}{=}
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{o}{(}write\PYG{+w}{ }procInstruction\PYG{o}{)}\PYG{+w}{ },\PYG{+w}{ }instruction\PYG{+w}{ }tapeInstruction
\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }\PYG{+w}{ }fillInputs\PYG{+w}{ }\PYG{o}{(}goOut\PYG{+w}{ }\PYGZus{}\PYG{+w}{ },\PYG{+w}{ }halt\PYG{o}{)}\PYG{+w}{ }tt\PYG{+w}{ }\PYG{o+ow}{=}\PYG{+w}{ }halt\PYG{+w}{ },\PYG{+w}{ }tt
\end{Verbatim}
